---
title: My dynamic report
output: html_fragment
---

```{r setup, include=FALSE}
library(tidyverse)
logged_data <- read.csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vQ7dXYzqjRIlKT8V1lk9EPfupxy_vnE5OZf3mQxCO2hZJ7J1qGscymtOGDXJEboMo6Iadpyv8kGZ6Ve/pub?output=csv")
names(logged_data)
# Rename the column to make it easier to organize the data
latest_data <- logged_data %>%
  rename(
    timestamp = Timestamp,
    time_of_completion = `X..Time.of.Completion`,
    time_period = `X...Current.Time.Period`,
    appliances_used = `X..Appliances.Used`,
    total_time_hours = `X....Total.time.of.use.of.all.appliance..hours.`
  )
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE, error=FALSE)

```

```{css}
<style>
  body {
    font-family: Arial, sans-serif;
    line-height: 1.6;
  }
  h2 {
    color: purple;
  }
</style>

```

## Appliance Usage Analysis by Time Period
### This report presents an analysis of appliance usage across different time periods. We will explore the total time appliances were used during the morning, afternoon, evening and midnight.

## Summary Statistics
### The average total time spent using appliances is r mean_time hours, and the maximum recorded time is r max_time hours.

## Time Period Distribution
### This bar chart displays the distribution of appliance usage across various time periods, with peak usage typically occurring during the afternoon and evening.
```{r}
ggplot(latest_data, aes(x = time_period)) +
  geom_bar(fill = "skyblue", color = "black") +
  labs(title = "Distribution of Appliance Usage by Time Period", x = "Time Period", y = "Frequency") + 
  theme_classic()+
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
  geom_text(stat='count', aes(label=..count..), vjust=-0.5)
```

## Number of Appliances Used
### This chart shows that users generally use 2 appliances at once, with the number of appliances used reaching up to 6 in some cases.
```{r}
latest_data$appliance_count <- str_count(latest_data$appliances_used, ",") + 1

ggplot(latest_data, aes(x = appliance_count)) +
  geom_bar(fill = "pink", color = "black") +
  labs(title = "Frequency of Appliances Used", x = "Number of Appliances", y = "Count") + 
  theme(axis.text.x = element_text(hjust = 1)) + 
  geom_text(stat='count', aes(label=..count..), vjust=-0.5) +
  scale_color_brewer(palette = "Dark2") +
  theme_minimal()
```



